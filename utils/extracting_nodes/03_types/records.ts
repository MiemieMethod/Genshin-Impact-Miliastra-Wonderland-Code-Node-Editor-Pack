import { ENUM_ID_CLIENT } from "../../node_data/index.ts";

// ref map: cid, type, ioc 
export const records = [
  {
    id: 200006,
    inputs: [
      null,
      "R<T>",
      "R<T>"
    ],
    outputs: [],
    reflectMap: [
      [
        11,
        5,
        0
      ],
      [
        12,
        3,
        1
      ],
      [
        13,
        7,
        2
      ],
      [
        14,
        9,
        3
      ],
      [
        15,
        14,
        4
      ],
      [
        16,
        1,
        5
      ],
      [
        17,
        11,
        6
      ],
      [
        18,
        16,
        7
      ],
      [
        19,
        18,
        8
      ],
      [
        20,
        19,
        9
      ]
    ]
  },
  {
    id: 200007,
    inputs: [
      null,
      "R<T>",
      "R<T>"
    ],
    outputs: [],
    reflectMap: [
      [
        12,
        3,
        0
      ],
      [
        13,
        7,
        1
      ]
    ]
  },
  {
    id: 200008,
    inputs: [
      null,
      "R<T>",
      "R<T>"
    ],
    outputs: [],
    reflectMap: [
      [
        12,
        3,
        0
      ],
      [
        13,
        7,
        1
      ]
    ]
  },
  {
    id: 200009,
    inputs: [
      null,
      "R<T>",
      "R<T>"
    ],
    outputs: [],
    reflectMap: [
      [
        12,
        3,
        0
      ],
      [
        13,
        7,
        1
      ]
    ]
  },
  {
    id: 200010,
    inputs: [
      null,
      "R<T>",
      "R<T>"
    ],
    outputs: [],
    reflectMap: [
      [
        12,
        3,
        0
      ],
      [
        13,
        7,
        1
      ]
    ]
  },
  {
    id: 200011,
    inputs: [
      null,
      "R<T>",
      "R<T>"
    ],
    outputs: [
      "R<T>"
    ],
    reflectMap: [
      [
        30,
        3,
        0
      ],
      [
        31,
        7,
        1
      ]
    ]
  },
  {
    id: 200012,
    inputs: [
      null,
      "R<T>",
      "R<T>"
    ],
    outputs: [
      "R<T>"
    ],
    reflectMap: [
      [
        30,
        3,
        0
      ],
      [
        31,
        7,
        1
      ]
    ]
  },
  {
    id: 200013,
    inputs: [
      null,
      "R<T>",
      "R<T>"
    ],
    outputs: [
      "R<T>"
    ],
    reflectMap: [
      [
        30,
        3,
        0
      ],
      [
        31,
        7,
        1
      ]
    ]
  },
  {
    id: 200014,
    inputs: [
      null,
      "R<T>",
      "R<T>"
    ],
    outputs: [
      "R<T>"
    ],
    reflectMap: [
      [
        30,
        3,
        0
      ],
      [
        31,
        7,
        1
      ]
    ]
  },
  {
    id: 200015,
    inputs: [
      "R<T>"
    ],
    outputs: [
      "R<T>"
    ],
    reflectMap: [
      [
        32,
        3,
        0
      ],
      [
        33,
        7,
        1
      ]
    ]
  },
  {
    id: 200016,
    inputs: [],
    outputs: [
      "R<T>"
    ],
    reflectMap: [
      [
        40,
        5,
        0
      ],
      [
        41,
        3,
        1
      ],
      [
        42,
        7,
        2
      ],
      [
        43,
        9,
        3
      ],
      [
        44,
        14,
        4
      ],
      [
        45,
        1,
        5
      ],
      [
        46,
        11,
        6
      ],
      [
        47,
        4,
        7
      ],
      [
        48,
        10,
        8
      ],
      [
        49,
        2,
        9
      ],
      [
        50,
        15,
        10
      ],
      [
        51,
        8,
        11
      ],
      [
        52,
        12,
        12
      ],
      [
        53,
        6,
        13
      ],
      [
        54,
        18,
        14
      ],
      [
        55,
        19,
        15
      ],
      [
        56,
        20,
        16
      ],
      [
        57,
        21,
        17
      ],
      [
        58,
        16,
        18
      ]
    ]
  },
  {
    id: 200017,
    inputs: [
      null,
      "L<R<T>>"
    ],
    outputs: [
      "R<T>"
    ],
    reflectMap: [
      [
        60,
        5,
        0
      ],
      [
        61,
        3,
        1
      ],
      [
        62,
        7,
        2
      ],
      [
        63,
        9,
        3
      ],
      [
        64,
        14,
        4
      ],
      [
        65,
        1,
        5
      ],
      [
        66,
        11,
        6
      ],
      [
        67,
        18,
        7
      ],
      [
        68,
        19,
        8
      ]
    ]
  },
  {
    id: 200018,
    inputs: [
      "R<T>"
    ],
    outputs: [],
    reflectMap: [
      [
        80,
        6,
        0
      ],
      [
        81,
        4,
        1
      ],
      [
        82,
        8,
        2
      ],
      [
        83,
        10,
        3
      ],
      [
        84,
        15,
        4
      ],
      [
        85,
        2,
        5
      ],
      [
        86,
        12,
        6
      ]
    ]
  },
  {
    id: 200019,
    inputs: [
      "R<T>",
      "L<R<T>>"
    ],
    outputs: [],
    reflectMap: [
      [
        100,
        5,
        0
      ],
      [
        101,
        3,
        1
      ],
      [
        102,
        7,
        2
      ],
      [
        103,
        9,
        3
      ],
      [
        104,
        14,
        4
      ],
      [
        105,
        1,
        5
      ],
      [
        106,
        11,
        6
      ],
      [
        107,
        18,
        7
      ],
      [
        108,
        19,
        8
      ]
    ]
  },
  {
    id: 200020,
    inputs: [
      "L<R<T>>"
    ],
    outputs: [
      "R<T>"
    ],
    reflectMap: [
      [
        120,
        3,
        0
      ],
      [
        121,
        7,
        1
      ]
    ]
  },
  {
    id: 200021,
    inputs: [
      "L<R<T>>"
    ],
    outputs: [
      "R<T>"
    ],
    reflectMap: [
      [
        122,
        3,
        0
      ],
      [
        123,
        7,
        1
      ]
    ]
  },
  {
    id: 200032,
    inputs: [
      "R<T>",
      "R<T>"
    ],
    outputs: [
      "R<T>"
    ],
    reflectMap: [
      [
        1011,
        3,
        0
      ],
      [
        1012,
        7,
        1
      ]
    ]
  },
  {
    id: 200081,
    inputs: [
      null,
      "R<T>"
    ],
    outputs: [],
    reflectMap: [
      [
        2000,
        3,
        0
      ],
      [
        2000,
        9,
        1
      ],
      [
        2000,
        1,
        2
      ],
      [
        2000,
        14,
        3
      ],
      [
        2000,
        7,
        4
      ],
      [
        2000,
        11,
        5
      ],
      [
        2000,
        5,
        6
      ],
      [
        2000,
        4,
        7
      ],
      [
        2000,
        10,
        8
      ],
      [
        2000,
        2,
        9
      ],
      [
        2000,
        15,
        10
      ],
      [
        2000,
        8,
        11
      ],
      [
        2000,
        12,
        12
      ],
      [
        2000,
        6,
        13
      ],
      [
        2000,
        18,
        14
      ],
      [
        2000,
        19,
        15
      ],
      [
        2000,
        16,
        16
      ]
    ]
  },
  {
    id: 200082,
    inputs: [],
    outputs: [
      "R<T>"
    ],
    reflectMap: [
      [
        1036,
        3,
        0
      ],
      [
        1036,
        9,
        1
      ],
      [
        1036,
        1,
        2
      ],
      [
        1036,
        14,
        3
      ],
      [
        1036,
        7,
        4
      ],
      [
        1036,
        11,
        5
      ],
      [
        1036,
        5,
        6
      ],
      [
        1036,
        4,
        7
      ],
      [
        1036,
        10,
        8
      ],
      [
        1036,
        2,
        9
      ],
      [
        1036,
        15,
        10
      ],
      [
        1036,
        8,
        11
      ],
      [
        1036,
        12,
        12
      ],
      [
        1036,
        6,
        13
      ],
      [
        1036,
        18,
        14
      ],
      [
        1036,
        19,
        15
      ],
      [
        1036,
        16,
        16
      ]
    ]
  }
];

const enum_equal = { // TODO: Enum equal
  id: 200005,
  inputs: [
    "R<T>",
    "R<T>"
  ],
  outputs: [],
  reflectMap: [
    [
      10,
      13,
      0
    ],
    [
      10,
      13,
      1
    ],
    [
      10,
      13,
      2
    ],
    [
      10,
      13,
      3
    ],
    [
      10,
      13,
      4
    ],
    [
      10,
      13,
      5
    ],
    [
      10,
      13,
      6
    ],
    [
      10,
      13,
      7
    ],
    [
      10,
      13,
      8
    ],
    [
      10,
      13,
      9
    ],
    [
      10,
      13,
      10
    ],
    [
      10,
      13,
      11
    ],
    [
      10,
      13,
      12
    ],
    [
      10,
      13,
      13
    ],
    [
      10,
      13,
      14
    ],
    [
      10,
      13,
      15
    ],
    [
      10,
      13,
      16
    ],
    [
      10,
      13,
      17
    ],
    [
      10,
      13,
      18
    ],
    [
      10,
      13,
      19
    ],
    [
      10,
      13,
      20
    ],
    [
      10,
      13,
      21
    ]
  ]
};

const type_conv =
{
  id: 200022,
  inputs: ["E<7>", "R<K>"],
  outputs: ["R<V>"],
  reflectMap: [
    [130, "S<K:Int,V:Bol>"],
    [130, "S<K:Bol,V:Int>"],
    [130, "S<K:Flt,V:Int>"],
    [130, "S<K:Int,V:Flt>"],
    [130, "S<K:Bol,V:Str>"],
    [130, "S<K:Int,V:Str>"],
    [130, "S<K:Flt,V:Str>"],
    [130, "S<K:Gid,V:Str>"],
    [130, "S<K:Ety,V:Str>"],
    [130, "S<K:Vec,V:Str>"],
    [130, "S<K:Fct,V:Str>"],
  ]
};

const assembly_list = {
  id: 200049,
  inputs: [
    null,
    "R<T>",
    "R<T>",
    "R<T>",
    "R<T>",
    "R<T>",
    "R<T>",
    "R<T>",
    "R<T>",
    "R<T>",
    "R<T>"
  ],
  outputs: [
    "L<R<T>>"
  ],
  reflectMap: [
    [1025, "S<T:Ety>"],
    [1026, "S<T:Int>"],
    [1027, "S<T:Bol>"],
    [1028, "S<T:Flt>"],
    [1029, "S<T:Str>"],
    [1030, "S<T:Vec>"],
    [1043, "S<T:Gid>"],
    [1044, "S<T:Cfg>"],
    [1045, "S<T:Pfb>"]
  ]
};

export const records_special = {
  enum_equal,
  type_conv,
  assembly_list
};



export function get_index_of_concrete(gid_cid_type: string): number;
export function get_index_of_concrete(gid: number, cid: number, type?: string): number;
export function get_index_of_concrete(gid: number | string, cid?: number, type?: string): number {
  if (typeof gid === "string") {
    const x = gid.split(" ");
    gid = parseInt(x[0]);
    cid = parseInt(x[1]);
    type = x[2];
  }
  const rec = records.find(r => r.id === gid);
  if (rec === undefined) {
    switch (gid) {
      case enum_equal.id:
        return parseInt(type!.slice(2, -1));
      case type_conv.id:
        return type_conv.reflectMap.findIndex(z => z[1] === type!.toString());
      case assembly_list.id:
        return assembly_list.reflectMap.findIndex(z => z[0] === cid);
    }
    throw new Error("Invalid record");
  }
  const ref = rec.reflectMap.find(x => x[0] === cid)!;
  return ref[2];
}

export const enums = `
Generic
Comparison Operators
Logical Operators
Basic Mathematical Operators
Attack Shapes
Survival Status
Sorting Rules
Rounding Logic
Type Conversions
Motion Path Point Types
Motion Types
Follow Location Type
Coordinate System Type
Elemental Type
Entity Type
Unit Status Addition Failure Reason
Unit Status Addition Success Type
Unit Status Removal Reason
Unit Status Removal Strategy
Revive Point Selection Strategy
Cause of Being Down
Trigonometric Functions
Disruptor Device Type
Disruptor Device Orientation
UI Control Group Status
Target Type
Quick Mathematical Operators
Hit Type
Attack Type
Hit Performance Level
Target Sorting Rules
Attack Layer Config
Knockback Direction Type
Rotation Type
Sector Detection Direction
Type Conversions
Retracing Type
Hit Level
Elemental Reaction Type
Filter Return Type
Target Type (For Camera Orientation Node)
Scan Status
Input Device Type
`;

export const enum_val = `
Modulo Operation
Exponentiation
Get Maximum Value
Get Minimum Value
Logarithm

Default Sorting
Random Order
Sort From Near to Far

Only On-Hit Hurtbox
Only On-Hit Scene
Hit All

Line Connecting Attacker and Hit Point
Hitbox On-Hit Direction
Line Connecting Attacker's Owner and Hit Point
Tangent Line Between Attacker and Hit Point
Opposite Direction to Hit
Attacker's Facing Orientation
Opposite Direction to Line Connecting Attacker and Hit Point

Target First, Then Input
Input Orientation
Target Orientation
Target First, Then Camera
Camera Orientation
Input First, Then Target

From Inside Out
Clockwise
Counterclockwise

Self
Self Owner
Top Layer Self Owner

No Effect
Light Tremor
Light Hit
Knockback Hit
Launch

Return Boolean
Return Integer

Don't Find Target
Allied Faction
Hostile Faction
Own Faction
All Except Self

Unusable Target
Current Scan Target
Candidate Target
Condition Not Met
`;
